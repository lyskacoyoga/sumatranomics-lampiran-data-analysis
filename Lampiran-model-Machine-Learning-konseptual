import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, mean_absolute_error
import numpy as np

# --- Lampiran: Kode Python untuk Pemodelan Konseptual Machine Learning ---
# Kode ini mendemonstrasikan proses konseptual penggunaan model Machine Learning
# (Linear Regression) untuk memprediksi harga beras ritel berdasarkan variabel
# ekonomi, produksi, dan iklim, sesuai dengan metodologi pada karya tulis.

# Baca data yang sudah diperbaiki
df = pd.read_csv('Data Fiks.xlsx - DATA FIKS.csv')

# 1. Pra-pemrosesan Data dan Pemilihan Fitur
# Kita akan menggunakan variabel-variabel ini untuk memprediksi harga beras ritel.
# Fitur (X): Variabel yang mempengaruhi, seperti produksi padi dan inflasi.
# Target (y): Variabel yang ingin diprediksi, yaitu harga beras ritel.
features = [
    'Produksi Padi (Ton)',
    'Inflasi Makanan YoY (%)',
    'Total Curah Hujan (mm)',
    'Akses Internet Penduduk (%)',
    'Panjang Jalan Km'
]
target = 'Harga Beras (Rp/Kg) (Harga Ritel)'

# Pastikan tidak ada missing values, meskipun sudah diperiksa sebelumnya.
df_clean = df.dropna(subset=features + [target])

X = df_clean[features]
y = df_clean[target]

# 2. Pembagian Data (Training dan Testing)
# Memisahkan data menjadi data latih (untuk melatih model) dan data uji (untuk menguji performa model).
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 3. Pemilihan dan Pelatihan Model
# Menggunakan model Linear Regression sebagai contoh model prediksi.
model = LinearRegression()
model.fit(X_train, y_train)

# 4. Prediksi dan Evaluasi
# Menggunakan model yang sudah dilatih untuk memprediksi harga pada data uji.
y_pred = model.predict(X_test)

# Menghitung metrik evaluasi
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
mae = mean_absolute_error(y_test, y_pred)
r2 = model.score(X_test, y_test)

# --- Output untuk Lampiran ---
print("Lampiran: Kode Python untuk Pemodelan Konseptual Machine Learning\n")
print("---------------------------------------------------------------")
print("Variabel Prediktor (Fitur):", features)
print("Variabel Target:", target)
print("\n--- Hasil Evaluasi Model pada Data Uji ---")
print(f"Mean Squared Error (MSE): {mse:.2f}")
print(f"Root Mean Squared Error (RMSE): {rmse:.2f}")
print(f"Mean Absolute Error (MAE): {mae:.2f}")
print(f"R-squared (RÂ²): {r2:.2f}")
print("\n--- Contoh Prediksi vs Nilai Aktual ---")
# Menampilkan beberapa contoh prediksi
predictions_df = pd.DataFrame({'Nilai Aktual': y_test, 'Prediksi': y_pred})
print(predictions_df.sample(5).to_string())

# Catatan: Kode ini adalah contoh konseptual. Untuk hasil yang lebih akurat, diperlukan model yang lebih kompleks dan data yang lebih spesifik.

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
